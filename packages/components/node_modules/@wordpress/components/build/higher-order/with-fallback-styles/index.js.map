{"version":3,"sources":["@wordpress/components/src/higher-order/with-fallback-styles/index.js"],"names":["mapNodeToProps","WrappedComponent","arguments","nodeRef","props","node","state","fallbackStyles","undefined","grabStylesCompleted","bindRef","bind","grabFallbackStyles","newFallbackStyles","setState","wrappedComponent","Component"],"mappings":";;;;;;;;;AAQA;;;;;;;;;;;;;;;;AALA;;AAMA;;;;;;eAEe,kBAAEA,cAAF;AAAA,SACd,yCAA4B,UAAEC,gBAAF,EAAwB;AACnD;AAAA;;AAAA;;AACC,wBAAc;AAAA;;AAAA;AACb,mCAAUC,SAAV;AACA,cAAKC,OAAL,GAAe,MAAKC,KAAL,CAAWC,IAA1B;AACA,cAAKC,KAAL,GAAa;AACZC,UAAAA,cAAc,EAAEC,SADJ;AAEZC,UAAAA,mBAAmB,EAAE;AAFT,SAAb;AAKA,cAAKC,OAAL,GAAe,MAAKA,OAAL,CAAaC,IAAb,6CAAf;AARa;AASb;;AAVF;AAAA;AAAA,gCAYUN,IAZV,EAYiB;AACf,cAAK,CAAEA,IAAP,EAAc;AACb;AACA;;AACD,eAAKF,OAAL,GAAeE,IAAf;AACA;AAjBF;AAAA;AAAA,4CAmBqB;AACnB,eAAKO,kBAAL;AACA;AArBF;AAAA;AAAA,6CAuBsB;AACpB,eAAKA,kBAAL;AACA;AAzBF;AAAA;AAAA,6CA2BsB;AAAA,4BAC4B,KAAKN,KADjC;AAAA,cACZG,mBADY,eACZA,mBADY;AAAA,cACSF,cADT,eACSA,cADT;;AAEpB,cAAK,KAAKJ,OAAL,IAAgB,CAAEM,mBAAvB,EAA6C;AAC5C,gBAAMI,iBAAiB,GAAGb,cAAc,CACvC,KAAKG,OADkC,EAEvC,KAAKC,KAFkC,CAAxC;;AAIA,gBAAK,CAAE,qBAASS,iBAAT,EAA4BN,cAA5B,CAAP,EAAsD;AACrD,mBAAKO,QAAL,CAAe;AACdP,gBAAAA,cAAc,EAAEM,iBADF;AAEdJ,gBAAAA,mBAAmB,EAAE,CAAC,CAAE,mBAAOI,iBAAP;AAFV,eAAf;AAIA;AACD;AACD;AAzCF;AAAA;AAAA,iCA2CU;AACR,cAAME,gBAAgB,GACrB,4BAAC,gBAAD,6BACM,KAAKX,KADX,EAEM,KAAKE,KAAL,CAAWC,cAFjB,EADD;AAMA,iBAAO,KAAKH,KAAL,CAAWC,IAAX,GACNU,gBADM,GAGN;AAAK,YAAA,GAAG,EAAG,KAAKL;AAAhB,kBAA6BK,gBAA7B,MAHD;AAKA;AAvDF;AAAA;AAAA,MAAqBC,kBAArB;AAyDA,GA1DD,EA0DG,oBA1DH,CADc;AAAA,C","sourcesContent":["/**\n * External dependencies\n */\nimport { every, isEqual } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\nexport default ( mapNodeToProps ) =>\n\tcreateHigherOrderComponent( ( WrappedComponent ) => {\n\t\treturn class extends Component {\n\t\t\tconstructor() {\n\t\t\t\tsuper( ...arguments );\n\t\t\t\tthis.nodeRef = this.props.node;\n\t\t\t\tthis.state = {\n\t\t\t\t\tfallbackStyles: undefined,\n\t\t\t\t\tgrabStylesCompleted: false,\n\t\t\t\t};\n\n\t\t\t\tthis.bindRef = this.bindRef.bind( this );\n\t\t\t}\n\n\t\t\tbindRef( node ) {\n\t\t\t\tif ( ! node ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.nodeRef = node;\n\t\t\t}\n\n\t\t\tcomponentDidMount() {\n\t\t\t\tthis.grabFallbackStyles();\n\t\t\t}\n\n\t\t\tcomponentDidUpdate() {\n\t\t\t\tthis.grabFallbackStyles();\n\t\t\t}\n\n\t\t\tgrabFallbackStyles() {\n\t\t\t\tconst { grabStylesCompleted, fallbackStyles } = this.state;\n\t\t\t\tif ( this.nodeRef && ! grabStylesCompleted ) {\n\t\t\t\t\tconst newFallbackStyles = mapNodeToProps(\n\t\t\t\t\t\tthis.nodeRef,\n\t\t\t\t\t\tthis.props\n\t\t\t\t\t);\n\t\t\t\t\tif ( ! isEqual( newFallbackStyles, fallbackStyles ) ) {\n\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\tfallbackStyles: newFallbackStyles,\n\t\t\t\t\t\t\tgrabStylesCompleted: !! every( newFallbackStyles ),\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trender() {\n\t\t\t\tconst wrappedComponent = (\n\t\t\t\t\t<WrappedComponent\n\t\t\t\t\t\t{ ...this.props }\n\t\t\t\t\t\t{ ...this.state.fallbackStyles }\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t\treturn this.props.node ? (\n\t\t\t\t\twrappedComponent\n\t\t\t\t) : (\n\t\t\t\t\t<div ref={ this.bindRef }> { wrappedComponent } </div>\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t}, 'withFallbackStyles' );\n"]}