{"version":3,"sources":["@wordpress/components/src/slot-fill/fill.js"],"names":["isFunction","createPortal","useLayoutEffect","useRef","Consumer","useSlot","occurrences","FillComponent","name","children","registerFill","unregisterFill","slot","ref","current","occurrence","forceUpdate","node","props","fillProps","Fill"],"mappings":";;;AAAA;;;AAGA,SAASA,UAAT,QAA2B,QAA3B;AAEA;;;;AAGA,SAASC,YAAT,EAAuBC,eAAvB,EAAwCC,MAAxC,QAAsD,oBAAtD;AAEA;;;;AAGA,SAASC,QAAT,EAAmBC,OAAnB,QAAkC,WAAlC;AAEA,IAAIC,WAAW,GAAG,CAAlB;;AAEA,SAASC,aAAT,OAA2E;AAAA,MAAjDC,IAAiD,QAAjDA,IAAiD;AAAA,MAA3CC,QAA2C,QAA3CA,QAA2C;AAAA,MAAjCC,YAAiC,QAAjCA,YAAiC;AAAA,MAAnBC,cAAmB,QAAnBA,cAAmB;AAC1E,MAAMC,IAAI,GAAGP,OAAO,CAAEG,IAAF,CAApB;AAEA,MAAMK,GAAG,GAAGV,MAAM,CAAE;AACnBK,IAAAA,IAAI,EAAJA,IADmB;AAEnBC,IAAAA,QAAQ,EAARA;AAFmB,GAAF,CAAlB;;AAKA,MAAK,CAAEI,GAAG,CAACC,OAAJ,CAAYC,UAAnB,EAAgC;AAC/BF,IAAAA,GAAG,CAACC,OAAJ,CAAYC,UAAZ,GAAyB,EAAET,WAA3B;AACA;;AAEDJ,EAAAA,eAAe,CAAE,YAAM;AACtBQ,IAAAA,YAAY,CAAEF,IAAF,EAAQK,GAAG,CAACC,OAAZ,CAAZ;AACA,WAAO;AAAA,aAAMH,cAAc,CAAEH,IAAF,EAAQK,GAAG,CAACC,OAAZ,CAApB;AAAA,KAAP;AACA,GAHc,EAGZ,EAHY,CAAf;AAKAZ,EAAAA,eAAe,CAAE,YAAM;AACtBW,IAAAA,GAAG,CAACC,OAAJ,CAAYL,QAAZ,GAAuBA,QAAvB;;AACA,QAAKG,IAAL,EAAY;AACXA,MAAAA,IAAI,CAACI,WAAL;AACA;AACD,GALc,EAKZ,CAAEP,QAAF,CALY,CAAf;AAOAP,EAAAA,eAAe,CAAE,YAAM;AACtB,QAAKM,IAAI,KAAKK,GAAG,CAACC,OAAJ,CAAYN,IAA1B,EAAiC;AAChC;AACA;AACA;;AACDG,IAAAA,cAAc,CAAEE,GAAG,CAACC,OAAJ,CAAYN,IAAd,EAAoBK,GAAG,CAACC,OAAxB,CAAd;AACAD,IAAAA,GAAG,CAACC,OAAJ,CAAYN,IAAZ,GAAmBA,IAAnB;AACAE,IAAAA,YAAY,CAAEF,IAAF,EAAQK,GAAG,CAACC,OAAZ,CAAZ;AACA,GARc,EAQZ,CAAEN,IAAF,CARY,CAAf;;AAUA,MAAK,CAAEI,IAAF,IAAU,CAAEA,IAAI,CAACK,IAAtB,EAA6B;AAC5B,WAAO,IAAP;AACA,GApCyE,CAsC1E;;;AACA,MAAKjB,UAAU,CAAES,QAAF,CAAf,EAA8B;AAC7BA,IAAAA,QAAQ,GAAGA,QAAQ,CAAEG,IAAI,CAACM,KAAL,CAAWC,SAAb,CAAnB;AACA;;AAED,SAAOlB,YAAY,CAAEQ,QAAF,EAAYG,IAAI,CAACK,IAAjB,CAAnB;AACA;;AAED,IAAMG,IAAI,GAAG,SAAPA,IAAO,CAAEF,KAAF;AAAA,SACZ,cAAC,QAAD,QACG;AAAA,QAAIR,YAAJ,SAAIA,YAAJ;AAAA,QAAkBC,cAAlB,SAAkBA,cAAlB;AAAA,WACD,cAAC,aAAD,eACMO,KADN;AAEC,MAAA,YAAY,EAAGR,YAFhB;AAGC,MAAA,cAAc,EAAGC;AAHlB,OADC;AAAA,GADH,CADY;AAAA,CAAb;;AAYA,eAAeS,IAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { isFunction } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { createPortal, useLayoutEffect, useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { Consumer, useSlot } from './context';\n\nlet occurrences = 0;\n\nfunction FillComponent( { name, children, registerFill, unregisterFill } ) {\n\tconst slot = useSlot( name );\n\n\tconst ref = useRef( {\n\t\tname,\n\t\tchildren,\n\t} );\n\n\tif ( ! ref.current.occurrence ) {\n\t\tref.current.occurrence = ++occurrences;\n\t}\n\n\tuseLayoutEffect( () => {\n\t\tregisterFill( name, ref.current );\n\t\treturn () => unregisterFill( name, ref.current );\n\t}, [] );\n\n\tuseLayoutEffect( () => {\n\t\tref.current.children = children;\n\t\tif ( slot ) {\n\t\t\tslot.forceUpdate();\n\t\t}\n\t}, [ children ] );\n\n\tuseLayoutEffect( () => {\n\t\tif ( name === ref.current.name ) {\n\t\t\t// ignore initial effect\n\t\t\treturn;\n\t\t}\n\t\tunregisterFill( ref.current.name, ref.current );\n\t\tref.current.name = name;\n\t\tregisterFill( name, ref.current );\n\t}, [ name ] );\n\n\tif ( ! slot || ! slot.node ) {\n\t\treturn null;\n\t}\n\n\t// If a function is passed as a child, provide it with the fillProps.\n\tif ( isFunction( children ) ) {\n\t\tchildren = children( slot.props.fillProps );\n\t}\n\n\treturn createPortal( children, slot.node );\n}\n\nconst Fill = ( props ) => (\n\t<Consumer>\n\t\t{ ( { registerFill, unregisterFill } ) => (\n\t\t\t<FillComponent\n\t\t\t\t{ ...props }\n\t\t\t\tregisterFill={ registerFill }\n\t\t\t\tunregisterFill={ unregisterFill }\n\t\t\t/>\n\t\t) }\n\t</Consumer>\n);\n\nexport default Fill;\n"]}