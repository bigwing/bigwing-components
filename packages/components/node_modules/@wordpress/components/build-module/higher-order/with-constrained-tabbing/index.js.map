{"version":3,"sources":["@wordpress/components/src/higher-order/with-constrained-tabbing/index.js"],"names":["Component","createRef","createHigherOrderComponent","TAB","focus","withConstrainedTabbing","WrappedComponent","arguments","focusContainRef","handleTabBehaviour","bind","event","keyCode","tabbables","tabbable","find","current","length","firstTabbable","lastTabbable","shiftKey","target","preventDefault","includes","props"],"mappings":";;;;;;;;;;;;AAAA;;;AAGA,SAASA,SAAT,EAAoBC,SAApB,QAAqC,oBAArC;AACA,SAASC,0BAAT,QAA2C,oBAA3C;AACA,SAASC,GAAT,QAAoB,qBAApB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AAEA,IAAMC,sBAAsB,GAAGH,0BAA0B,CACxD,UAAEI,gBAAF;AAAA;AAAA;;AAAA;;AAEE,sBAAc;AAAA;;AAAA;;AACb,iCAAUC,SAAV;AAEA,YAAKC,eAAL,GAAuBP,SAAS,EAAhC;AACA,YAAKQ,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBC,IAAxB,+BAA1B;AAJa;AAKb;;AAPH;AAAA;AAAA,yCASsBC,KATtB,EAS8B;AAC3B,YAAKA,KAAK,CAACC,OAAN,KAAkBT,GAAvB,EAA6B;AAC5B;AACA;;AAED,YAAMU,SAAS,GAAGT,KAAK,CAACU,QAAN,CAAeC,IAAf,CACjB,KAAKP,eAAL,CAAqBQ,OADJ,CAAlB;;AAGA,YAAK,CAAEH,SAAS,CAACI,MAAjB,EAA0B;AACzB;AACA;;AACD,YAAMC,aAAa,GAAGL,SAAS,CAAE,CAAF,CAA/B;AACA,YAAMM,YAAY,GAAGN,SAAS,CAAEA,SAAS,CAACI,MAAV,GAAmB,CAArB,CAA9B;;AAEA,YAAKN,KAAK,CAACS,QAAN,IAAkBT,KAAK,CAACU,MAAN,KAAiBH,aAAxC,EAAwD;AACvDP,UAAAA,KAAK,CAACW,cAAN;AACAH,UAAAA,YAAY,CAACf,KAAb;AACA,SAHD,MAGO,IACN,CAAEO,KAAK,CAACS,QAAR,IACAT,KAAK,CAACU,MAAN,KAAiBF,YAFX,EAGL;AACDR,UAAAA,KAAK,CAACW,cAAN;AACAJ,UAAAA,aAAa,CAACd,KAAd;AACA;;;;AAIA,SAVM,MAUA,IAAK,CAAES,SAAS,CAACU,QAAV,CAAoBZ,KAAK,CAACU,MAA1B,CAAP,EAA4C;AAClDV,UAAAA,KAAK,CAACW,cAAN;AACAJ,UAAAA,aAAa,CAACd,KAAd;AACA;AACD;AAxCH;AAAA;AAAA,+BA0CW;AACR;AACA;;AACA;AACA,eACC;AACC,UAAA,SAAS,EAAG,KAAKK,kBADlB;AAEC,UAAA,GAAG,EAAG,KAAKD,eAFZ;AAGC,UAAA,QAAQ,EAAC;AAHV,WAKC,cAAC,gBAAD,EAAuB,KAAKgB,KAA5B,CALD,CADD;AASA;AACA;AAxDH;;AAAA;AAAA,IACexB,SADf;AAAA,CADwD,EA2DxD,wBA3DwD,CAAzD;AA8DA,eAAeK,sBAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component, createRef } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\nimport { TAB } from '@wordpress/keycodes';\nimport { focus } from '@wordpress/dom';\n\nconst withConstrainedTabbing = createHigherOrderComponent(\n\t( WrappedComponent ) =>\n\t\tclass extends Component {\n\t\t\tconstructor() {\n\t\t\t\tsuper( ...arguments );\n\n\t\t\t\tthis.focusContainRef = createRef();\n\t\t\t\tthis.handleTabBehaviour = this.handleTabBehaviour.bind( this );\n\t\t\t}\n\n\t\t\thandleTabBehaviour( event ) {\n\t\t\t\tif ( event.keyCode !== TAB ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst tabbables = focus.tabbable.find(\n\t\t\t\t\tthis.focusContainRef.current\n\t\t\t\t);\n\t\t\t\tif ( ! tabbables.length ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst firstTabbable = tabbables[ 0 ];\n\t\t\t\tconst lastTabbable = tabbables[ tabbables.length - 1 ];\n\n\t\t\t\tif ( event.shiftKey && event.target === firstTabbable ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tlastTabbable.focus();\n\t\t\t\t} else if (\n\t\t\t\t\t! event.shiftKey &&\n\t\t\t\t\tevent.target === lastTabbable\n\t\t\t\t) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tfirstTabbable.focus();\n\t\t\t\t\t/*\n\t\t\t\t\t * When pressing Tab and none of the tabbables has focus, the keydown\n\t\t\t\t\t * event happens on the wrapper div: move focus on the first tabbable.\n\t\t\t\t\t */\n\t\t\t\t} else if ( ! tabbables.includes( event.target ) ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tfirstTabbable.focus();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trender() {\n\t\t\t\t// Disable reason: this component is non-interactive, but must capture\n\t\t\t\t// events from the wrapped component to determine when the Tab key is used.\n\t\t\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\t\t\treturn (\n\t\t\t\t\t<div\n\t\t\t\t\t\tonKeyDown={ this.handleTabBehaviour }\n\t\t\t\t\t\tref={ this.focusContainRef }\n\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<WrappedComponent { ...this.props } />\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\t\t\t}\n\t\t},\n\t'withConstrainedTabbing'\n);\n\nexport default withConstrainedTabbing;\n"]}