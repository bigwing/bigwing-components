{"version":3,"sources":["@wordpress/components/src/mobile/link-settings/index.native.js"],"names":["Platform","Clipboard","compose","withSelect","isURL","prependHTTP","useEffect","useState","useRef","link","external","BottomSheet","PanelBody","TextControl","ToggleControl","UnsupportedFooterControl","PanelActions","LinkRelIcon","styles","NEW_TAB_REL","LinkSettings","isVisible","onClose","attributes","setAttributes","onEmptyURL","options","withBottomSheet","actions","editorSidebarOpened","showIcon","url","label","linkTarget","rel","urlInputValue","setUrlInputValue","labelInputValue","setLabelInputValue","linkRelInputValue","setLinkRelInputValue","prevEditorSidebarOpenedRef","current","prevEditorSidebarOpened","isSettingSheetOpen","autoFill","getURLFromClipboard","onSetAttributes","onChangeURL","value","onChangeLabel","onCloseSettingsSheet","onChangeOpenInNewTab","newLinkTarget","undefined","updatedRel","onChangeLinkRel","getString","clipboardText","getSettings","placeholder","OS","autoFocus","linkLabel","openInNewTab","linkRel","linkSettingsPanel","footer","select","isEditorSidebarOpened"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { Platform, Clipboard } from 'react-native';\n/**\n * WordPress dependencies\n */\nimport { compose } from '@wordpress/compose';\nimport { withSelect } from '@wordpress/data';\nimport { isURL, prependHTTP } from '@wordpress/url';\nimport { useEffect, useState, useRef } from '@wordpress/element';\nimport { link, external } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\n/**\n * Internal dependencies\n */\nimport BottomSheet from '../bottom-sheet';\nimport PanelBody from '../../panel/body';\nimport TextControl from '../../text-control';\nimport ToggleControl from '../../toggle-control';\nimport UnsupportedFooterControl from '../../unsupported-footer-control';\nimport PanelActions from '../../panel/actions';\nimport LinkRelIcon from './link-rel';\n\nimport styles from './style.scss';\n\nconst NEW_TAB_REL = 'noreferrer noopener';\n\nfunction LinkSettings( {\n\t// Control link settings `BottomSheet` visibility\n\tisVisible,\n\t// Callback that is called on closing bottom sheet\n\tonClose,\n\t// Object of attributes to be set or updated in `LinkSettings`\n\tattributes,\n\t// Function called to set attributes\n\tsetAttributes,\n\t// Callback that is called when url input field is empty\n\tonEmptyURL,\n\t// Object of available options along with specific, customizable properties.\n\t// Available options keys:\n\t//\t* url - uses `TextControl` component to set `attributes.url`\n\t//\t* linkLabel - uses `TextControl` component to set `attributes.label`\n\t//\t* openInNewTab - uses `ToggleControl` component to set `attributes.linkTarget` and `attributes.rel`\n\t//\t* linkRel - uses `TextControl` component to set `attributes.rel`\n\t//\t* footer - uses `UnsupportedFooterControl` component to display message, e.g. about missing functionality\n\t// Available properties:\n\t//\t* label - control component label, e.g. `Button Link URL`\n\t//\t* placeholder - control component placeholder, e.g. `Add URL`\n\t//\t* autoFocus (url only) - whether url input should be focused on sheet opening\n\t//\t* autoFill (url only) - whether url input should be filled with url from clipboard\n\t// Example:\n\t//\tconst options = {\n\t//\t\turl: {\n\t//\t\t\tlabel: __( 'Button Link URL' ),\n\t//\t\t\tplaceholder: __( 'Add URL' ),\n\t//\t\t\tautoFocus: true,\n\t//\t\t\tautoFill: true,\n\t//\t\t}\n\t//\t}\n\toptions,\n\t// Specifies whether settings should be wrapped into `BottomSheet`\n\twithBottomSheet,\n\t// Defines buttons which will be displayed below the all options.\n\t// It's an array of objects with following properties:\n\t//\t* label - button title\n\t//\t* onPress - callback that is called on pressing button\n\t// Example:\n\t// \tconst actions = [\n\t//\t\t{\n\t//\t\t\tlabel: __( 'Remove link' ),\n\t//\t\t\tonPress: () => setAttributes({ url: '' }),\n\t//\t\t},\n\t//\t];\n\tactions,\n\t// Specifies whether general `BottomSheet` is opened\n\teditorSidebarOpened,\n\t// Specifies whether icon should be displayed next to the label\n\tshowIcon,\n} ) {\n\tconst { url, label, linkTarget, rel } = attributes;\n\tconst [ urlInputValue, setUrlInputValue ] = useState( '' );\n\tconst [ labelInputValue, setLabelInputValue ] = useState( '' );\n\tconst [ linkRelInputValue, setLinkRelInputValue ] = useState( '' );\n\tconst prevEditorSidebarOpenedRef = useRef();\n\n\tuseEffect( () => {\n\t\tprevEditorSidebarOpenedRef.current = editorSidebarOpened;\n\t} );\n\tconst prevEditorSidebarOpened = prevEditorSidebarOpenedRef.current;\n\n\tuseEffect( () => {\n\t\tsetUrlInputValue( url || '' );\n\t}, [ url ] );\n\n\tuseEffect( () => {\n\t\tsetLabelInputValue( label || '' );\n\t}, [ label ] );\n\n\tuseEffect( () => {\n\t\tsetLinkRelInputValue( rel || '' );\n\t}, [ rel ] );\n\n\tuseEffect( () => {\n\t\tconst isSettingSheetOpen = isVisible || editorSidebarOpened;\n\t\tif ( options.url.autoFill && isSettingSheetOpen && ! url ) {\n\t\t\tgetURLFromClipboard();\n\t\t}\n\n\t\tif ( prevEditorSidebarOpened && ! editorSidebarOpened ) {\n\t\t\tonSetAttributes();\n\t\t}\n\t}, [ editorSidebarOpened, isVisible ] );\n\n\tfunction onChangeURL( value ) {\n\t\tif ( ! value && onEmptyURL ) {\n\t\t\tonEmptyURL();\n\t\t}\n\t\tsetUrlInputValue( value );\n\t}\n\n\tfunction onChangeLabel( value ) {\n\t\tsetLabelInputValue( value );\n\t}\n\n\tfunction onSetAttributes() {\n\t\tsetAttributes( {\n\t\t\turl: prependHTTP( urlInputValue ),\n\t\t\tlabel: labelInputValue,\n\t\t\trel: linkRelInputValue,\n\t\t} );\n\t}\n\n\tfunction onCloseSettingsSheet() {\n\t\tonSetAttributes();\n\t\tonClose();\n\t}\n\n\tfunction onChangeOpenInNewTab( value ) {\n\t\tconst newLinkTarget = value ? '_blank' : undefined;\n\n\t\tlet updatedRel = rel;\n\t\tif ( newLinkTarget && ! rel ) {\n\t\t\tupdatedRel = NEW_TAB_REL;\n\t\t} else if ( ! newLinkTarget && rel === NEW_TAB_REL ) {\n\t\t\tupdatedRel = undefined;\n\t\t}\n\n\t\tsetAttributes( {\n\t\t\tlinkTarget: newLinkTarget,\n\t\t\trel: updatedRel,\n\t\t} );\n\t}\n\n\tfunction onChangeLinkRel( value ) {\n\t\tsetLinkRelInputValue( value );\n\t}\n\n\tasync function getURLFromClipboard() {\n\t\tconst clipboardText = await Clipboard.getString();\n\n\t\tif ( ! clipboardText ) {\n\t\t\treturn;\n\t\t}\n\t\t// Check if pasted text is URL\n\t\tif ( ! isURL( clipboardText ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetAttributes( { url: clipboardText } );\n\t}\n\n\tfunction getSettings() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ options.url && (\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\ticon={ showIcon && link }\n\t\t\t\t\t\tlabel={ options.url.label }\n\t\t\t\t\t\tvalue={ urlInputValue }\n\t\t\t\t\t\tvaluePlaceholder={ options.url.placeholder }\n\t\t\t\t\t\tonChange={ onChangeURL }\n\t\t\t\t\t\tonSubmit={ onCloseSettingsSheet }\n\t\t\t\t\t\tautoCapitalize=\"none\"\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\t// eslint-disable-next-line jsx-a11y/no-autofocus\n\t\t\t\t\t\tautoFocus={\n\t\t\t\t\t\t\tPlatform.OS === 'ios' && options.url.autoFocus\n\t\t\t\t\t\t}\n\t\t\t\t\t\tkeyboardType=\"url\"\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ options.linkLabel && (\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={ options.linkLabel.label }\n\t\t\t\t\t\tvalue={ labelInputValue }\n\t\t\t\t\t\tvaluePlaceholder={ options.linkLabel.placeholder }\n\t\t\t\t\t\tonChange={ onChangeLabel }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ options.openInNewTab && (\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\ticon={ showIcon && external }\n\t\t\t\t\t\tlabel={ options.openInNewTab.label }\n\t\t\t\t\t\tchecked={ linkTarget === '_blank' }\n\t\t\t\t\t\tonChange={ onChangeOpenInNewTab }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ options.linkRel && (\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\ticon={ showIcon && LinkRelIcon }\n\t\t\t\t\t\tlabel={ options.linkRel.label }\n\t\t\t\t\t\tvalue={ linkRelInputValue }\n\t\t\t\t\t\tvaluePlaceholder={ options.linkRel.placeholder }\n\t\t\t\t\t\tonChange={ onChangeLinkRel }\n\t\t\t\t\t\tonSubmit={ onCloseSettingsSheet }\n\t\t\t\t\t\tautoCapitalize=\"none\"\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\tkeyboardType=\"url\"\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</>\n\t\t);\n\t}\n\n\tif ( ! withBottomSheet ) {\n\t\treturn getSettings();\n\t}\n\n\treturn (\n\t\t<BottomSheet\n\t\t\tisVisible={ isVisible }\n\t\t\tonClose={ onCloseSettingsSheet }\n\t\t\thideHeader\n\t\t>\n\t\t\t<PanelBody style={ styles.linkSettingsPanel }>\n\t\t\t\t{ getSettings() }\n\t\t\t</PanelBody>\n\t\t\t{ options.footer && (\n\t\t\t\t<PanelBody style={ styles.linkSettingsPanel }>\n\t\t\t\t\t<UnsupportedFooterControl label={ options.footer.label } />\n\t\t\t\t</PanelBody>\n\t\t\t) }\n\t\t\t{ actions && <PanelActions actions={ actions } /> }\n\t\t</BottomSheet>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { isEditorSidebarOpened } = select( 'core/edit-post' );\n\t\treturn {\n\t\t\teditorSidebarOpened: isEditorSidebarOpened(),\n\t\t};\n\t} ),\n] )( LinkSettings );\n"]}