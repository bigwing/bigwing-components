{"version":3,"sources":["@wordpress/rich-text/src/change-list-type.js"],"names":["LINE_SEPARATOR","getLineIndex","getParentLineIndex","changeListType","value","newFormat","text","replacements","start","end","startingLineIndex","startLineFormats","endLineFormats","startIndex","newReplacements","slice","startCount","length","endCount","changed","index","map","format","i"],"mappings":";;;;;;AAAA;;;AAIA,SAASA,cAAT,QAA+B,sBAA/B;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,SAASC,kBAAT,QAAmC,yBAAnC;AAEA;;;;;;;;;;;;;AAYA,OAAO,SAASC,cAAT,CAAyBC,KAAzB,EAAgCC,SAAhC,EAA4C;AAAA,MAC1CC,IAD0C,GACPF,KADO,CAC1CE,IAD0C;AAAA,MACpCC,YADoC,GACPH,KADO,CACpCG,YADoC;AAAA,MACtBC,KADsB,GACPJ,KADO,CACtBI,KADsB;AAAA,MACfC,GADe,GACPL,KADO,CACfK,GADe;AAElD,MAAMC,iBAAiB,GAAGT,YAAY,CAAEG,KAAF,EAASI,KAAT,CAAtC;AACA,MAAMG,gBAAgB,GAAGJ,YAAY,CAAEG,iBAAF,CAAZ,IAAqC,EAA9D;AACA,MAAME,cAAc,GAAGL,YAAY,CAAEN,YAAY,CAAEG,KAAF,EAASK,GAAT,CAAd,CAAZ,IAA8C,EAArE;AACA,MAAMI,UAAU,GAAGX,kBAAkB,CAAEE,KAAF,EAASM,iBAAT,CAArC;AACA,MAAMI,eAAe,GAAGP,YAAY,CAACQ,KAAb,EAAxB;AACA,MAAMC,UAAU,GAAGL,gBAAgB,CAACM,MAAjB,GAA0B,CAA7C;AACA,MAAMC,QAAQ,GAAGN,cAAc,CAACK,MAAf,GAAwB,CAAzC;AAEA,MAAIE,OAAJ;;AAEA,OAAM,IAAIC,KAAK,GAAGP,UAAU,GAAG,CAAb,IAAkB,CAApC,EAAuCO,KAAK,GAAGd,IAAI,CAACW,MAApD,EAA4DG,KAAK,EAAjE,EAAsE;AACrE,QAAKd,IAAI,CAAEc,KAAF,CAAJ,KAAkBpB,cAAvB,EAAwC;AACvC;AACA;;AAED,QAAK,CAAEc,eAAe,CAAEM,KAAF,CAAf,IAA4B,EAA9B,EAAmCH,MAAnC,IAA6CD,UAAlD,EAA+D;AAC9D;AACA;;AAED,QAAK,CAAEF,eAAe,CAAEM,KAAF,CAAtB,EAAkC;AACjC;AACA;;AAEDD,IAAAA,OAAO,GAAG,IAAV;AACAL,IAAAA,eAAe,CAAEM,KAAF,CAAf,GAA2BN,eAAe,CAAEM,KAAF,CAAf,CAAyBC,GAAzB,CAC1B,UAAEC,MAAF,EAAUC,CAAV,EAAiB;AAChB,aAAOA,CAAC,GAAGP,UAAJ,IAAkBO,CAAC,GAAGL,QAAtB,GAAiCI,MAAjC,GAA0CjB,SAAjD;AACA,KAHyB,CAA3B;AAKA;;AAED,MAAK,CAAEc,OAAP,EAAiB;AAChB,WAAOf,KAAP;AACA;;AAED,2BACIA,KADJ;AAECG,IAAAA,YAAY,EAAEO;AAFf;AAIA","sourcesContent":["/**\n * Internal dependencies\n */\n\nimport { LINE_SEPARATOR } from './special-characters';\nimport { getLineIndex } from './get-line-index';\nimport { getParentLineIndex } from './get-parent-line-index';\n\n/**\n * Changes the list type of the selected indented list, if any. Looks at the\n * currently selected list item and takes the parent list, then changes the list\n * type of this list. When multiple lines are selected, the parent lists are\n * takes and changed.\n *\n * @param {Object} value     Value to change.\n * @param {Object} newFormat The new list format object. Choose between\n *                           `{ type: 'ol' }` and `{ type: 'ul' }`.\n *\n * @return {Object} The changed value.\n */\nexport function changeListType( value, newFormat ) {\n\tconst { text, replacements, start, end } = value;\n\tconst startingLineIndex = getLineIndex( value, start );\n\tconst startLineFormats = replacements[ startingLineIndex ] || [];\n\tconst endLineFormats = replacements[ getLineIndex( value, end ) ] || [];\n\tconst startIndex = getParentLineIndex( value, startingLineIndex );\n\tconst newReplacements = replacements.slice();\n\tconst startCount = startLineFormats.length - 1;\n\tconst endCount = endLineFormats.length - 1;\n\n\tlet changed;\n\n\tfor ( let index = startIndex + 1 || 0; index < text.length; index++ ) {\n\t\tif ( text[ index ] !== LINE_SEPARATOR ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ( ( newReplacements[ index ] || [] ).length <= startCount ) {\n\t\t\tbreak;\n\t\t}\n\n\t\tif ( ! newReplacements[ index ] ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tchanged = true;\n\t\tnewReplacements[ index ] = newReplacements[ index ].map(\n\t\t\t( format, i ) => {\n\t\t\t\treturn i < startCount || i > endCount ? format : newFormat;\n\t\t\t}\n\t\t);\n\t}\n\n\tif ( ! changed ) {\n\t\treturn value;\n\t}\n\n\treturn {\n\t\t...value,\n\t\treplacements: newReplacements,\n\t};\n}\n"]}